<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Live Sports Streams</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      background:#000;
      color:#fff;
      font-family:Arial, sans-serif;
      margin:0;
      padding:0;
    }

    h1 {
      text-align:center;
      margin:20px 0 10px;
    }

    /* Tabs bar */
    .tabs {
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:8px;
      padding:10px 5px 15px;
      border-bottom:1px solid #222;
    }

    .tab-button {
      background:#111;
      color:#0af;
      border:1px solid #0af;
      border-radius:999px;
      padding:8px 14px;
      font-size:14px;
      cursor:pointer;
      outline:none;
    }

    .tab-button.active {
      background:#0af;
      color:#000;
      font-weight:bold;
    }

    /* Tab content sections */
    .tab-content {
      display:none;
      padding:10px 10px 40px;
    }

    .tab-content.active {
      display:block;
    }

    .section {
      max-width:900px;
      margin:20px auto;
      text-align:center;
    }

    .section h2 {
      margin-bottom:10px;
      font-size:18px;
    }

    iframe {
      width:100%;
      height:400px;
      border:0;
      background:#000;
    }

    .empty-message {
      max-width:900px;
      margin:40px auto;
      text-align:center;
      color:#888;
      font-size:14px;
    }
  </style>
</head>
<body>

<h1>Live Sports Streams</h1>

<!-- TAB BUTTONS -->
<div class="tabs">
  <button class="tab-button active" data-tab="football_early">
    ‚öΩ Football (12:00‚Äì3:30 PM)
  </button>
  <button class="tab-button" data-tab="football_late">
    ‚öΩ Football (3:31 PM‚Äì12:00 AM)
  </button>
  <button class="tab-button" data-tab="basketball">
    üèÄ Basketball
  </button>
  <button class="tab-button" data-tab="fighting">
    ü•ä Fighting
  </button>
  <button class="tab-button" data-tab="other">
    üéÆ Other Sports
  </button>
</div>

<!-- TAB CONTENT AREAS -->
<div id="football_early" class="tab-content active">
  <div class="empty-message">No football streams between 12:00 and 3:30 PM yet.</div>
</div>

<div id="football_late" class="tab-content">
  <div class="empty-message">No football streams between 3:31 PM and 12:00 AM yet.</div>
</div>

<div id="basketball" class="tab-content">
  <div class="empty-message">No basketball streams yet.</div>
</div>

<div id="fighting" class="tab-content">
  <div class="empty-message">No fighting streams yet.</div>
</div>

<div id="other" class="tab-content">
  <div class="empty-message">No other sports streams yet.</div>
</div>

<script>
// ---- CONFIG: YOUR GOOGLE SHEET JSON URL ----
const SHEET_JSON_URL =
  "https://docs.google.com/spreadsheets/d/15PSX1c3VavO3KcTZWCdfVEheZNiBduTrYf4Bv4Klz3k/gviz/tq?gid=0&tqx=out:json"
  + "&cache=" + Date.now();

// Simple time range helper (expects HH:MM 24h)
function isBetween(time, start, end) {
  if (!time) return false;
  return time >= start && time <= end;
}

// Tab switching
const tabButtons = document.querySelectorAll(".tab-button");
const tabContents = document.querySelectorAll(".tab-content");

tabButtons.forEach(btn => {
  btn.addEventListener("click", () => {
    const target = btn.dataset.tab;

    tabButtons.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    tabContents.forEach(content => {
      content.classList.toggle("active", content.id === target);
    });
  });
});

async function loadStreams() {
  try {
    const res = await fetch(SHEET_JSON_URL);
    const text = await res.text();

    // Google Sheets gviz JSON needs cleaning
    const json = JSON.parse(text.substr(47).slice(0, -2));
    const rows = json.table.rows;

    // Track if we added anything to each tab
    const hasContent = {
      football_early: false,
      football_late: false,
      basketball: false,
      fighting: false,
      other: false
    };

    rows.forEach(row => {
      let title    = row.c[0]?.v || "";
      let url      = row.c[1]?.v || "";
      let category = row.c[2]?.v || "";
      let time     = row.c[3]?.v || "";

      if (!url || !url.startsWith("http")) return;

      // Decide which tab this row belongs in
      let tabId = null;

      if (category === "Football" && isBetween(time, "12:00", "15:30")) {
        tabId = "football_early";
      } else if (category === "Football" && isBetween(time, "15:31", "23:59")) {
        tabId = "football_late";
      } else if (category === "Basketball") {
        tabId = "basketball";
      } else if (category === "Fighting") {
        tabId = "fighting";
      } else if (category === "Other") {
        tabId = "other";
      }

      if (!tabId) return;

      const tabDiv = document.getElementById(tabId);
      if (!hasContent[tabId]) {
        // remove "no streams" message the first time we add something
        tabDiv.innerHTML = "";
        hasContent[tabId] = true;
      }

      tabDiv.innerHTML += `
        <div class="section">
          <h2>${title} ${time ? `(${time})` : ""}</h2>
          <iframe src="${url}" allowfullscreen
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture">
          </iframe>
        </div>
      `;
    });
  } catch (e) {
    console.error(e);
  }
}

loadStreams();
</script>

</body>
</html>
