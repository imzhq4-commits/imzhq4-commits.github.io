<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Live Sports Streams</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      background:#000;
      color:#fff;
      font-family:Arial, sans-serif;
      margin:0;
      padding:0;
    }

    h1 {
      text-align:center;
      margin:16px 0 10px;
      font-size:24px;
    }

    /* Tabs bar across top */
    .tabs {
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:6px;
      padding:8px 6px 10px;
      border-bottom:1px solid #222;
      background:#050505;
      position:sticky;
      top:0;
      z-index:10;
    }

    .tab-button {
      background:#111;
      color:#0af;
      border:1px solid #0af;
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      cursor:pointer;
      outline:none;
      white-space:nowrap;
    }

    .tab-button.active {
      background:#0af;
      color:#000;
      font-weight:bold;
    }

    /* Content area */
    #content {
      padding:10px 10px 40px;
    }

    .section {
      max-width:900px;
      margin:20px auto;
      text-align:center;
    }

    .section h2 {
      margin-bottom:10px;
      font-size:16px;
    }

    iframe {
      width:100%;
      height:400px;
      border:0;
      background:#000;
    }

    .message {
      max-width:900px;
      margin:30px auto;
      text-align:center;
      color:#aaa;
      font-size:14px;
    }

    .loader {
      max-width:900px;
      margin:30px auto;
      text-align:center;
      font-size:14px;
      color:#0af;
    }
  </style>
</head>
<body>

<h1>Live Sports Streams</h1>

<!-- TABS ACROSS THE TOP -->
<div class="tabs">
  <button class="tab-button active" data-category="Football A">
    ‚öΩ Football 12:30‚Äì3:30 PM
  </button>
  <button class="tab-button" data-category="Football B">
    ‚öΩ Football 4:00‚Äì9:00 PM
  </button>
  <button class="tab-button" data-category="Basketball">
    üèÄ Basketball
  </button>
  <button class="tab-button" data-category="Fighting">
    ü•ä Fighting
  </button>
  <button class="tab-button" data-category="Other">
    üéÆ Other
  </button>
</div>

<!-- WHERE STREAMS WILL APPEAR -->
<div id="content">
  <div class="loader">Loading streams‚Ä¶</div>
</div>

<script>
  // ---- CONFIG: YOUR SHEET ----
  const SHEET_ID = "15PSX1c3VavO3KcTZWCdfVEheZNiBduTrYf4Bv4Klz3k";
  const GID = "0"; // first tab in the spreadsheet

  const SHEET_JSON_URL =
    "https://docs.google.com/spreadsheets/d/" + SHEET_ID +
    "/gviz/tq?gid=" + GID + "&tqx=out:json&cache=" + Date.now();

  const tabButtons = document.querySelectorAll(".tab-button");
  const contentDiv = document.getElementById("content");

  let allRows = [];          // will hold ALL data from sheet
  let sheetLoaded = false;   // so we only fetch once

  // Switch active tab + show its category
  tabButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      tabButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      const category = btn.dataset.category;
      showCategory(category);
    });
  });

  // Fetch sheet once, then filter by category when tabs are clicked
  async function loadSheet() {
    try {
      const res = await fetch(SHEET_JSON_URL);
      const text = await res.text();

      // Clean Google gviz wrapper
      const json = JSON.parse(text.substr(47).slice(0, -2));
      const rows = json.table.rows || [];

      allRows = rows.map(r => ({
        title:    r.c[0]?.v || "",
        url:      r.c[1]?.v || "",
        category: r.c[2]?.v || ""
      }));

      sheetLoaded = true;

      // Show default tab (Football A)
      showCategory("Football A");
    } catch (err) {
      console.error(err);
      contentDiv.innerHTML =
        '<div class="message">Could not load data from Google Sheets. Check sharing / publish settings.</div>';
    }
  }

  // Render streams for given category
  function showCategory(categoryName) {
    if (!sheetLoaded) {
      // If user clicks quickly before sheet has loaded
      contentDiv.innerHTML = '<div class="loader">Loading streams‚Ä¶</div>';
      return;
    }

    const items = allRows.filter(
      row => row.category && row.category.trim().toLowerCase() === categoryName.toLowerCase()
    );

    if (!items.length) {
      contentDiv.innerHTML =
        '<div class="message">No streams found for <strong>' + categoryName + '</strong> yet.</div>';
      return;
    }

    let html = "";
    items.forEach(item => {
      if (!item.url || !item.url.startsWith("http")) return;

      html += `
        <div class="section">
          <h2>${item.title}</h2>
          <iframe
            src="${item.url}"
            allowfullscreen
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture">
          </iframe>
        </div>
      `;
    });

    contentDiv.innerHTML = html || '<div class="message">No valid links for this category.</div>';
  }

  // Initial load
  loadSheet();
</script>

</body>
</html>
